import{r as n,j as s,I as q}from"./index-rPRHDhdG.js";const V=({project:i,isOpen:u,onClose:I})=>{const l=n.useRef(null),b=n.useRef([]),d=n.useRef(null),N=n.useRef(null),k=n.useRef(1),f=n.useRef(null),h=n.useRef(null),w=n.useRef(!1),y=n.useRef({pointerId:null,startX:0,startY:0,startScrollLeft:0,isDragging:!1,hasPointer:!1}),[P,R]=n.useState(null),[L,S]=n.useState(!1),[j,C]=n.useState(!1),v=(i==null?void 0:i.photos)??[],p=v.length>1?5:1,E=n.useMemo(()=>v.length?Array.from({length:p},(e,r)=>v.map((t,o)=>({src:t,key:`${r}-${o}`,index:o,copyIndex:r}))).flat():[],[v,p]);n.useEffect(()=>{k.current=p},[p]),n.useEffect(()=>{N.current=P},[P]),n.useEffect(()=>()=>{d.current&&(cancelAnimationFrame(d.current),d.current=null),f.current&&(clearTimeout(f.current),f.current=null),h.current&&(clearTimeout(h.current),h.current=null)},[]),n.useEffect(()=>{if(!u)return;const e=()=>{I()},r={passive:!0};return window.addEventListener("scroll",e,r),()=>window.removeEventListener("scroll",e,r)},[u,I]);const Y=e=>{e.stopPropagation()},D=()=>{const e=l.current;if(!e)return null;const r=b.current;if(!r.length)return null;const t=e.scrollLeft+e.clientWidth/2;let o=null,c=Number.POSITIVE_INFINITY;return r.forEach(a=>{const m=a.offsetLeft+a.offsetWidth/2,x=Math.abs(t-m);x<c&&(c=x,o=a)}),o},g=()=>{const e=D();if(!e)return;const r=e==null?void 0:e.dataset.photoIndex,t=r!==void 0?Number(r):null;t!==null&&!Number.isNaN(t)&&t!==N.current&&(N.current=t,R(t))},M=()=>{const e=l.current,r=k.current;if(!e||r<=1)return;const t=e.scrollWidth/r;if(!t)return;const o=Math.floor(r/2),c=t*(o-.5),a=t*(o+.5);for(;e.scrollLeft<c;)e.scrollLeft+=t;for(;e.scrollLeft>a;)e.scrollLeft-=t},T=()=>{if(w.current)return;const e=D();e&&(w.current=!0,e.scrollIntoView({inline:"center",block:"nearest",behavior:"smooth"}),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{w.current=!1},240))},$=()=>{d.current||(d.current=requestAnimationFrame(()=>{if(!l.current){d.current=null;return}g(),d.current=null}),!w.current&&(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{y.current.isDragging||(M(),g(),T()),C(!1)},160)))},A=n.useCallback(e=>{if(!l.current)return;const r=Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.deltaX:e.deltaY;Math.abs(r)<.01||(e.cancelable&&e.preventDefault(),C(!0),l.current.scrollLeft+=r*.5)},[]);n.useEffect(()=>{if(!u)return;const e=l.current;if(!e)return;const r=t=>A(t);return e.addEventListener("wheel",r,{passive:!1}),()=>e.removeEventListener("wheel",r)},[A,u]);const z=e=>{l.current&&e.pointerType!=="touch"&&(e.pointerType==="mouse"&&e.button!==0||(y.current={pointerId:e.pointerId,startX:e.clientX,startY:e.clientY,startScrollLeft:l.current.scrollLeft,isDragging:!1,hasPointer:!0},l.current.setPointerCapture(e.pointerId)))},X=e=>{const r=l.current,t=y.current;if(!r||!t.hasPointer||t.pointerId!==e.pointerId)return;const o=e.clientX-t.startX,c=e.clientY-t.startY,a=6,m=.9;if(!t.isDragging){if(Math.abs(o)<a&&Math.abs(c)<a)return;if(Math.abs(c)>Math.abs(o)){t.hasPointer=!1;try{r.releasePointerCapture(e.pointerId)}catch{}return}t.isDragging=!0,S(!0)}e.preventDefault(),r.scrollLeft=t.startScrollLeft-o*m},W=e=>{const r=l.current,t=y.current;if(!(!t.hasPointer||t.pointerId!==e.pointerId)){if(t.hasPointer=!1,t.isDragging=!1,S(!1),r)try{r.releasePointerCapture(e.pointerId)}catch{}M(),g(),T()}};return n.useEffect(()=>{if(!u)return;const e=l.current;if(!e||!E.length)return;const t=requestAnimationFrame(()=>{b.current=Array.from(e.querySelectorAll("[data-photo-key]"));const a=`${Math.floor(k.current/2)}-0`,m=e.querySelector(`[data-photo-key="${a}"]`);if(m)m.scrollIntoView({inline:"center",block:"nearest"}),R(0);else if(b.current[0]){const x=b.current[0].dataset.photoIndex,F=x!==void 0?Number(x):null;R(F)}g()}),o=()=>g();return window.addEventListener("resize",o),()=>{cancelAnimationFrame(t),window.removeEventListener("resize",o)}},[E.length,u,i==null?void 0:i.name]),u?s.jsx("div",{className:"fixed inset-0 z-[999999] flex items-center justify-center bg-black/50 p-4",children:s.jsxs("div",{className:"project-modal relative w-[92%] max-w-4xl overflow-y-auto rounded-3xl border border-white/10 bg-[#0f111a] px-6 py-6 text-white shadow-md sm:w-full sm:px-10 sm:py-9 max-h-[85vh]",onClick:Y,children:[s.jsx("style",{children:`
          .project-carousel {
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
            touch-action: pan-x;
          }
          .project-carousel::-webkit-scrollbar {
            width: 0;
            height: 0;
            display: none;
          }
        `}),s.jsxs("div",{className:"mb-4 flex items-center justify-between border-b border-white/10 pb-4",children:[s.jsx("h2",{className:"text-lg font-semibold tracking-wide text-white sm:text-2xl",children:i.name}),s.jsx("button",{type:"button",onClick:I,"aria-label":"Close project details",className:"rounded-full border border-white/10 bg-white/5 p-2 text-white/70 transition hover:text-white",children:s.jsx(q,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"relative my-4 sm:my-6",children:[s.jsx("div",{ref:l,onScroll:$,onPointerDown:z,onPointerMove:X,onPointerUp:W,onPointerCancel:W,className:`project-carousel flex gap-1 sm:gap-2 overflow-x-auto px-4 sm:px-6 pb-3 select-none ${L||j?"snap-none":"snap-x snap-mandatory"} ${L?"cursor-grabbing":"cursor-grab"}`,children:E.map(e=>{const r=e.index===P;return s.jsx("div",{"data-photo-key":e.key,"data-photo-index":e.index,className:`snap-center flex-none w-[17rem] sm:w-[23rem] md:w-[27rem] ${j?"transition-none":"transition-[opacity,transform] duration-300 ease-out"} ${r?"opacity-100 scale-[1.05]":"opacity-35 scale-[0.86]"}`,children:s.jsx("div",{className:"h-[12rem] sm:h-[14rem] md:h-[16rem] overflow-hidden rounded-2xl flex items-center justify-center",children:s.jsx("img",{src:e.src,alt:`Project image ${e.index+1}`,className:"object-contain w-full h-full",draggable:"false",loading:e.copyIndex===Math.floor(p/2)&&e.index===0?"eager":"lazy",decoding:"async",onDragStart:t=>t.preventDefault()})})},e.key)})}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-10 bg-gradient-to-r from-[#0f111a] to-transparent"}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-10 bg-gradient-to-l from-[#0f111a] to-transparent"})]}),s.jsx("ul",{className:"list-disc pl-5 py-2 text-white/80",children:i.bullets.map((e,r)=>s.jsx("li",{children:e},r))}),s.jsxs("div",{className:"flex gap-3",children:[i.link===null?s.jsx("span",{className:"inline-block bg-[#4d52ff] text-white p-2 mt-2 rounded hover:cursor-not-allowed",children:"Private Repo"}):s.jsx("a",{href:i.link,target:"_blank",rel:"noopener noreferrer",className:"inline-block bg-[#4d52ff] text-white p-2 mt-2 rounded hover:cursor-pointer hover:text-white",children:"Link"}),i.website?s.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",className:"inline-block bg-[#4d52ff] text-white p-2 mt-2 rounded hover:cursor-pointer hover:text-white",children:"Website"}):null]})]})}):null};export{V as default};
