import{r as l,j as r,m as le,L as me,I as he,a as xe}from"./index-BxmET9-4.js";const $=6,we=({isOpen:a,onClose:S,photos:i=[],title:se="Photo Gallery",isLoading:m=!1})=>{const[v,T]=l.useState($),E=l.useRef(null),q=l.useRef(null),Y=l.useRef(v),j=l.useRef(null),[c,ae]=l.useState(!1),[L,I]=l.useState(null),[w,M]=l.useState(null),N=l.useRef(null),B=l.useRef(null),_=l.useRef(null),H=l.useRef(null),F=l.useRef(0),g=l.useRef(null),C=l.useRef(""),K=l.useRef(null),V=l.useRef(null),d=l.useRef(null),Z=l.useRef(null),J=l.useRef(null),Q=l.useRef({rowHeight:0}),X=l.useRef(2),[R,G]=l.useState(null),[ie,U]=l.useState(!1),[O,z]=l.useState(!1),k=typeof window<"u"&&"IntersectionObserver"in window,W=!!(w&&!c),ee=l.useMemo(()=>{let e=-1/0,t=null;return i.forEach(n=>{if(!(n!=null&&n.date))return;const s=Date.parse(n.date);Number.isNaN(s)||s>e&&(e=s,t=n.date)}),t},[i]),ce=l.useMemo(()=>new Intl.DateTimeFormat("en-US",{month:"short"}),[]),te=()=>{W&&M(null)},P=e=>{if(!e)return null;const t=Date.parse(e);if(Number.isNaN(t))return null;const n=new Date(t);return{month:ce.format(n),year:String(n.getFullYear())}},oe=e=>{var u,f;if(!i.length||v<=0)return;const t=Math.min(v,i.length)-1;let n=Math.min(Math.max(e,0),t),s=P((u=i[n])==null?void 0:u.date);if(!s)for(let h=n+1;h<=t&&(s=P((f=i[h])==null?void 0:f.date),!s);h+=1);if(!s)return;const o=`${s.month}-${s.year}`;o!==C.current&&(C.current=o,G(s))},re=(e=!1)=>{e&&!c&&(g.current&&clearTimeout(g.current),U(!0),g.current=setTimeout(()=>{U(!1),g.current=null},650)),!j.current&&(j.current=requestAnimationFrame(()=>{const t=E.current;if(!t){j.current=null;return}const{scrollTop:n,clientHeight:s,scrollHeight:o}=t,u=Math.max(o-s,1),f=Math.min(Math.max(n/u,0),1);let h=s*.2;if(!c){const p=H.current;if(p){let x=F.current;x||(x=p.offsetHeight,F.current=x);const y=Math.max(s-x,0)*f;h=y+x/2,p.style.transform=`translate3d(0, ${Math.round(y)}px, 0)`}if(v>0){const x=X.current;let b=0;if(x>0){const y=Q.current.rowHeight;if(y>0){const A=n+h;b=Math.max(0,Math.round((A-y/2)/y))*x}else{const A=n+h,D=Math.min(Math.max(A/Math.max(o,1),0),1);b=Math.floor(D*(v-1))}}oe(b)}}!k&&!m&&i.length>v&&o-n-s<120&&T(p=>Math.min(p+$,i.length)),j.current=null}))},ne=()=>{d.current&&(clearTimeout(d.current),d.current=null),!(!a||c||m||i.length===0)&&(d.current=setTimeout(()=>{z(!0),d.current=null},1500))},ue=()=>{c||(z(!1),ne()),re(!0)};l.useEffect(()=>{if(!a)return;const e=n=>{n.key==="Escape"&&S()},t=document.body.style.overflow;return document.body.style.overflow="hidden",window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e),document.body.style.overflow=t}},[a,S]),l.useEffect(()=>{a&&T(Math.min($,i.length))},[a,i.length]),l.useEffect(()=>{const e=window.matchMedia("(pointer: coarse)"),t=()=>ae(e.matches);return t(),e.addEventListener?(e.addEventListener("change",t),()=>e.removeEventListener("change",t)):(e.addListener(t),()=>e.removeListener(t))},[]),l.useEffect(()=>{a||(I(null),M(null),U(!1),G(null),z(!1),C.current="",g.current&&(clearTimeout(g.current),g.current=null),d.current&&(clearTimeout(d.current),d.current=null))},[a]),l.useEffect(()=>{c&&M(null)},[c]),l.useEffect(()=>{if(!a||c||m||i.length===0){z(!1),d.current&&(clearTimeout(d.current),d.current=null);return}return ne(),()=>{d.current&&(clearTimeout(d.current),d.current=null)}},[a,c,m,i.length]),l.useEffect(()=>{var t;if(!a||m||i.length===0||C.current)return;const e=P((t=i[0])==null?void 0:t.date);e&&(C.current=`${e.month}-${e.year}`,G(e))},[a,m,i,P]),l.useEffect(()=>{const e=window.matchMedia("(min-width: 640px)"),t=()=>{X.current=e.matches?3:2};return t(),e.addEventListener?(e.addEventListener("change",t),()=>e.removeEventListener("change",t)):(e.addListener(t),()=>e.removeListener(t))},[]),l.useEffect(()=>{if(!a||m||i.length===0)return;const e=Z.current,t=J.current;if(!e||!t)return;const n=()=>{const o=t.getBoundingClientRect(),u=window.getComputedStyle(e),f=Number.parseFloat(u.rowGap||"0")||0;Q.current={rowHeight:o.height+f}};if(n(),typeof ResizeObserver>"u")return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n);const s=new ResizeObserver(n);return s.observe(e),()=>s.disconnect()},[a,m,i.length,v]),l.useEffect(()=>{H.current&&(F.current=H.current.offsetHeight)},[R,a]),l.useEffect(()=>{if(!a||c)return;const e=B.current,t=V.current,n=K.current;if(!e||!t||!n)return;const s=()=>{const u=e.getBoundingClientRect(),f=t.getBoundingClientRect(),h=n.getBoundingClientRect(),x=f.left-u.left-h.width-36,b=f.top-u.top+(f.height-h.height)/2+30;n.style.left=`${Math.round(x)}px`,n.style.top=`${Math.round(b)}px`};if(s(),typeof ResizeObserver>"u")return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s);const o=new ResizeObserver(s);return o.observe(e),o.observe(t),()=>o.disconnect()},[a,c,O]),l.useEffect(()=>{!a||m||re(!1)},[a,m,v,i.length]),l.useEffect(()=>{if(!(!c||!L))return N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{I(null),N.current=null},3e3),()=>{N.current&&(clearTimeout(N.current),N.current=null)}},[L,c]),l.useEffect(()=>{if(!a||c||!R)return;const e=B.current,t=E.current,n=_.current;if(!e||!t||!n)return;const s=()=>{const u=e.getBoundingClientRect(),f=t.getBoundingClientRect(),h=n.offsetWidth,x=f.left-u.left-h-10;n.style.top=`${Math.round(f.top-u.top)}px`,n.style.left=`${Math.round(x)}px`,n.style.height=`${Math.round(f.height)}px`};if(s(),typeof ResizeObserver>"u")return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s);const o=new ResizeObserver(s);return o.observe(t),o.observe(e),()=>o.disconnect()},[a,c,R]),l.useEffect(()=>{if(!a||m||i.length<=v||k)return;const e=E.current;e&&e.scrollHeight<=e.clientHeight+8&&T(t=>Math.min(t+$,i.length))},[a,m,i.length,v,k]),l.useEffect(()=>{Y.current=v},[v]),l.useEffect(()=>()=>{j.current&&(cancelAnimationFrame(j.current),j.current=null),g.current&&(clearTimeout(g.current),g.current=null),d.current&&(clearTimeout(d.current),d.current=null)},[]),l.useEffect(()=>{if(!k||!a||m)return;const e=E.current,t=q.current;if(!e||!t)return;let n=null;const s=new IntersectionObserver(o=>{o.some(u=>u.isIntersecting)&&(Y.current>=i.length||n||(n=requestAnimationFrame(()=>{T(u=>Math.min(u+$,i.length)),n=null})))},{root:e,rootMargin:"200px 0px",threshold:.01});return s.observe(t),()=>{s.disconnect(),n&&cancelAnimationFrame(n)}},[k,a,m,i.length]);const de=e=>{e.stopPropagation()},fe=(e,t,n)=>{if(e.stopPropagation(),c){I(s=>s===n?null:n);return}M(s=>(s==null?void 0:s.src)===t.src?null:t)};return r.jsx(le.div,{className:`fixed inset-0 z-[99] flex items-center justify-center bg-black/50 p-4 ${a?"":"pointer-events-none"}`,onClick:a?S:void 0,role:"dialog","aria-modal":a,"aria-hidden":!a,"aria-labelledby":"photo-gallery-title",initial:"closed",animate:a?"open":"closed",variants:{open:{opacity:1},closed:{opacity:0}},transition:{duration:.1,ease:"easeOut"},children:r.jsxs("div",{ref:B,className:`relative w-full max-w-5xl sm:max-w-[44rem] transition-transform duration-200 ease-out ${W?"sm:-translate-x-6 lg:-translate-x-8":""}`,children:[c?null:r.jsx("div",{ref:K,className:`pointer-events-none absolute left-0 top-0 z-20 transition-[opacity,transform] duration-200 ease-out ${O?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:r.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-[0.65rem] font-semibold uppercase tracking-[0.2em] text-white/80",children:[r.jsx(me,{className:"h-4 w-4 animate-bounce"}),"scroll"]})}),!c&&R?r.jsx("div",{ref:_,className:"pointer-events-none absolute left-0 top-0 h-0 w-16 sm:w-24 z-10",children:r.jsx("div",{ref:H,className:"absolute left-0 top-0 will-change-transform",children:r.jsx("div",{className:`transition-[opacity,transform] duration-200 ease-out ${ie?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:r.jsxs("div",{className:"relative rounded-xl bg-gradient-to-b from-[#4d52ff] to-[#cf3dfd] p-[1px] shadow-lg",children:[r.jsx("span",{"aria-hidden":"true",className:"absolute right-0 top-1/2 h-3 w-2 -translate-y-1/2 translate-x-full bg-gradient-to-b from-[#4d52ff] to-[#cf3dfd]",style:{clipPath:"polygon(0 0, 100% 50%, 0 100%)"}}),r.jsxs("div",{className:"flex flex-col items-center rounded-xl bg-[#0b0d14]/90 px-4 py-2 backdrop-blur",children:[r.jsx("span",{className:"text-[0.7rem] font-semibold uppercase tracking-[0.2em] text-white/80 leading-none",children:R.month}),r.jsx("span",{className:"text-[0.85rem] font-medium text-white/60 leading-none",children:R.year})]})]})})})}):null,r.jsxs(le.div,{className:"w-full h-[85vh] max-h-[85vh] min-h-[32rem] overflow-hidden rounded-3xl border border-white/10 bg-[#0f111a] shadow-md flex flex-col",onClick:de,variants:{open:{opacity:1},closed:{opacity:0}},transition:{duration:.1,ease:"easeOut"},children:[r.jsxs("div",{className:"flex-shrink-0 border-b border-white/10 px-6 pt-6 pb-4 sm:px-8 sm:pt-8",onClick:te,children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[r.jsx("h2",{id:"photo-gallery-title",className:"text-lg font-semibold tracking-wide text-white sm:text-xl",children:se}),r.jsx("div",{className:"flex flex-col items-end gap-1 justify-between",children:r.jsx("button",{type:"button",onClick:S,"aria-label":"Close gallery",className:"rounded-full border border-white/10 bg-white/5 p-2 text-white/70 transition hover:text-white",children:r.jsx(he,{className:"h-4 w-4"})})})]}),r.jsxs("div",{ref:V,className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsx("p",{className:"text-sm text-white/90",children:"visual diary"}),ee?r.jsxs("span",{className:"text-[0.7rem] font-medium tracking-wide text-transparent bg-gradient-to-r from-[#4d52ff] to-[#cf3dfd] bg-clip-text",children:["UPDATED: ",ee]}):null]})]}),r.jsx("div",{className:"flex-1 min-h-0 overflow-hidden pt-4 pb-6 sm:pt-6 sm:pb-8",children:r.jsx("div",{className:"relative flex h-full min-h-0",children:r.jsx("div",{ref:E,onScroll:ue,onClick:()=>{c?I(null):M(null)},className:"min-w-0 flex-1 min-h-0 overflow-y-auto overflow-x-hidden overscroll-contain sm:w-full photo-gallery-scrollbar",style:{direction:"rtl"},children:r.jsx("div",{className:"w-full px-4 sm:px-6",style:{direction:"ltr"},children:m?r.jsx("div",{className:"grid w-full max-w-[40rem] grid-cols-2 gap-4 sm:grid-cols-3","aria-busy":"true",children:Array.from({length:6}).map((e,t)=>r.jsx("div",{className:"h-[12.5rem] rounded-2xl border border-white/10 bg-white/5 animate-pulse sm:h-[17.25rem]"},`gallery-skeleton-${t}`))}):i.length===0?r.jsx("p",{className:"text-sm text-white/60",children:"No photos to display."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:Z,className:"grid w-full max-w-[40rem] grid-cols-2 gap-4 sm:grid-cols-3",children:i.slice(0,v).map((e,t)=>{const n=`${e.src}-${e.alt}`,s=c&&L===n,o=!c&&(w==null?void 0:w.src)===e.src,u=c?"":"group-hover:opacity-100",f=c?"":"group-hover:translate-y-0",h=c?"":"group-hover:scale-105",p=s?"opacity-100":"opacity-0",x=s?"translate-y-0":"translate-y-2",b=c?"cursor-pointer":"hover:cursor-pointer",y=o?"bg-gradient-to-r from-[#4d52ff] to-[#cf3dfd]":"bg-white/10";return r.jsx("div",{ref:t===0?J:null,className:`group relative overflow-hidden rounded-2xl p-[1px] transition-colors duration-150 ${y} ${b}`,onClick:D=>fe(D,e,n),children:r.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-[calc(1rem-1px)] bg-white/5",children:[r.jsx("img",{src:e.src,alt:e.alt,loading:"lazy",decoding:"async",className:`h-[12.5rem] w-full object-cover transition-transform duration-300 ease-out will-change-transform ${h} sm:h-[17.25rem]`}),e.date?r.jsx("span",{className:`pointer-events-none absolute left-3 top-3 rounded-md bg-black/70 px-2 py-1 text-[0.65rem] text-white/90 transition-opacity duration-300 ease-out ${p} ${u}`,children:e.date}):null,e.description?r.jsx("span",{className:`pointer-events-none absolute inset-x-3 bottom-3 rounded-md bg-black/70 px-2 py-1 text-[0.65rem] text-white/90 transition-[opacity,transform] duration-300 ease-out will-change-transform ${p} ${x} ${u} ${f}`,children:e.description}):null]})},n)})}),r.jsx("div",{ref:q,className:"h-px w-full","aria-hidden":"true"})]})})})})})]}),c?null:r.jsx("div",{onClick:e=>e.stopPropagation(),className:`absolute top-0 left-full ml-4 h-fit overflow-hidden transition-[opacity,transform] duration-150 ease-out ${W?"w-[18rem] sm:w-[22rem] lg:w-[26rem] opacity-100 translate-x-0 pointer-events-auto":"w-[18rem] sm:w-[22rem] lg:w-[26rem] opacity-0 translate-x-2 pointer-events-none"}`,style:{willChange:"opacity, transform"},children:w?r.jsxs("div",{className:"relative h-full px-4 flex flex-col",children:[r.jsxs("button",{type:"button",onClick:te,className:"inline-flex items-center gap-1 bg-transparent p-0 w-16 text-[0.65rem] font-semibold uppercase tracking-[0.12em] text-white transition-transform duration-150 hover:scale-105 border-0 outline-none focus:outline-none focus-visible:outline-none",children:[r.jsx(xe,{className:"h-3.5 w-3.5"}),"Close"]}),r.jsx("div",{className:"mt-3 flex items-center justify-center",children:r.jsx("div",{className:"w-full rounded-2xl bg-gradient-to-r from-[#4d52ff] to-[#cf3dfd] p-[1px]",children:r.jsxs("div",{className:"relative w-full overflow-hidden rounded-[calc(1rem-1px)] bg-white/5",children:[r.jsx("img",{src:w.src,alt:w.alt,className:"w-full max-h-[55vh] object-contain"}),w.date?r.jsx("span",{className:"pointer-events-none absolute left-3 top-3 rounded-md bg-black/70 px-2 py-1 text-sm text-white/90",children:w.date}):null,w.description?r.jsx("span",{className:"pointer-events-none absolute inset-x-3 bottom-3 rounded-md bg-black/70 px-2 py-1 text-sm text-white/90",children:w.description}):null]})})})]}):null})]})})};export{we as default};
